<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الموقع الجامعي - حاسبة GPA</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* أنماط إضافية لصفحة GPA */
        .selection-system {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px 0;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .selection-group {
            flex: 1;
            min-width: 250px;
        }

        .selection-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .selection-select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: white;
            font-size: 1rem;
        }

        .available-courses {
            margin: 30px 0;
        }

        .courses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .course-checkbox {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .course-checkbox:hover {
            transform: translateY(-5px);
        }

        .course-checkbox input {
            margin-left: 15px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .course-info {
            flex: 1;
        }

        .course-info h4 {
            margin-bottom: 5px;
            color: var(--primary-color);
        }

        .course-info p {
            color: #666;
            font-size: 0.9rem;
        }

        .no-courses {
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin: 30px 0;
        }

        .no-courses i {
            font-size: 3rem;
            color: #ddd;
            margin-bottom: 20px;
        }

        .no-courses p {
            color: #777;
            font-size: 1.2rem;
        }

        .selected-courses-title {
            color: var(--primary-color);
            margin: 30px 0 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
        }

        /* تحسينات للشاشات الصغيرة */
        @media (max-width: 768px) {
            .selection-system {
                flex-direction: column;
            }
            
            .selection-group {
                min-width: 100%;
            }
            
            .courses-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- شريط التنقل -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <a href="index.html">
                    <svg width="40" height="40" viewBox="0 0 50 50">
                        <circle cx="25" cy="25" r="20" fill="#2c3e50"/>
                        <path d="M25 10 L30 20 L40 20 L32 27 L35 37 L25 30 L15 37 L18 27 L10 20 L20 20 Z" fill="#ecf0f1"/>
                    </svg>
                    <span>الموقع الجامعي</span>
                </a>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="index.html" class="nav-link"><i class="fas fa-home"></i> الرئيسية</a></li>
                <li class="nav-item"><a href="library.html" class="nav-link"><i class="fas fa-book"></i> المكتبة</a></li>
                <li class="nav-item"><a href="schedule.html" class="nav-link"><i class="fas fa-calendar-alt"></i> الجداول</a></li>
                <li class="nav-item"><a href="gpa.html" class="nav-link active"><i class="fas fa-calculator"></i> حاسبة GPA</a></li>
                <li class="nav-item"><a href="links.html" class="nav-link"><i class="fas fa-link"></i> الروابط</a></li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- البانر -->
    <header class="banner">
        <div class="banner-content">
            <h1>حاسبة المعدل التراكمي (GPA)</h1>
            <p>احسب معدلك التراكمي بسهولة ودقة</p>
        </div>
        <svg class="wave" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
            <path fill="#ffffff" fill-opacity="1" d="M0,224L48,213.3C96,203,192,181,288,181.3C384,181,480,203,576,192C672,181,768,139,864,138.7C960,139,1056,181,1152,186.7C1248,192,1344,160,1392,144L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
        </svg>
    </header>

    <!-- المحتوى الرئيسي -->
    <main class="container">
        <section class="welcome-section">
            <h2>حاسبة المعدل التراكمي (GPA)</h2>
            <p>اختر القسم والمستوى لعرض المواد الخاصة بك، ثم أدخل درجاتك لحساب المعدل</p>
        </section>

        <!-- نظام اختيار القسم والمستوى -->
        <div class="selection-system">
            <div class="selection-group">
                <label for="department">اختر القسم:</label>
                <select id="department" class="selection-select">
                    <option value="">-- اختر القسم --</option>
                    <option value="civil">هندسة مدنية</option>
                    <option value="architecture">هندسة عمارة</option>
                    <option value="electrical">هندسة كهربائية</option>
                </select>
            </div>

            <div class="selection-group">
                <label for="level">اختر المستوى:</label>
                <select id="level" class="selection-select" disabled>
                    <option value="">-- اختر المستوى --</option>
                    <option value="1">المستوى الأول</option>
                    <option value="2">المستوى الثاني</option>
                    <option value="3">المستوى الثالث</option>
                    <option value="4">المستوى الرابع</option>
                </select>
            </div>
        </div>

        <!-- المواد المتاحة -->
        <div id="availableCourses" class="available-courses" style="display: none;">
            <h3>المواد المتاحة:</h3>
            <p>اختر المواد التي تريد إضافتها لحساب المعدل:</p>
            <div id="coursesList" class="courses-grid">
                <!-- سيتم ملء المحتوى هنا عبر JavaScript -->
            </div>
            <button type="button" id="addSelectedCourses" class="btn" style="margin-top: 20px;">
                <i class="fas fa-plus"></i> إضافة المواد المختارة
            </button>
        </div>

        <!-- المواد المختارة -->
        <h3 id="selectedCoursesTitle" class="selected-courses-title" style="display: none;">المواد المختارة:</h3>
        
        <div class="gpa-calculator">
            <form id="gpaForm">
                <div id="coursesContainer">
                    <!-- سيتم إضافة المواد المختارة هنا -->
                    <div class="no-courses" id="noCoursesMessage">
                        <i class="fas fa-book-open"></i>
                        <p>لم يتم إضافة أي مواد بعد. اختر القسم والمستوى ثم اختر المواد الخاصة بك.</p>
                    </div>
                </div>
                
                <button type="button" id="addCourseBtn" class="add-course" style="display: none;">
                    <i class="fas fa-plus"></i> إضافة مادة أخرى
                </button>
                
                <button type="submit" class="calculate-btn" style="display: none;">احسب المعدل</button>
            </form>
            
            <div id="result" class="result" style="display: none;">
                <h3>معدلك التراكمي هو:</h3>
                <div class="result-value" id="gpaValue">0.00</div>
            </div>
        </div>
    </main>

    <!-- الفوتر -->
    <footer class="footer">
        <p>&copy; 2023 الموقع الجامعي. جميع الحقوق محفوظة.</p>
    </footer>

    <!-- زر العودة للأعلى -->
    <button id="backToTop" class="back-to-top">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script>
        // بيانات المواد الدراسية لكل قسم ومستوى
        const coursesData = {
            civil: {
                1: [
                    { id: "math1", name: "رياضيات 1", hours: 3 },
                    { id: "physics1", name: "فيزياء 1", hours: 4 },
                    { id: "programming", name: "مقدمة في البرمجة", hours: 3 },
                    { id: "english1", name: "لغة إنجليزية 1", hours: 2 },
                    { id: "national", name: "تربية وطنية", hours: 1 }
                ],
                2: [
                    { id: "math2", name: "رياضيات 2", hours: 3 },
                    { id: "statics", name: "استاتيكا", hours: 4 },
                    { id: "materials", name: "مواد بناء", hours: 3 },
                    { id: "drawing", name: "رسم هندسي", hours: 2 },
                    { id: "english2", name: "لغة إنجليزية 2", hours: 2 }
                ]
            },
            architecture: {
                1: [
                    { id: "design1", name: "تصميم 1", hours: 4 },
                    { id: "arch_drawing", name: "رسم معماري", hours: 3 },
                    { id: "theory", name: "نظرية العمارة", hours: 2 },
                    { id: "history", name: "تاريخ العمارة", hours: 2 },
                    { id: "visual", name: "تعبير بصري", hours: 2 }
                ],
                2: [
                    { id: "design2", name: "تصميم 2", hours: 4 },
                    { id: "structures", name: "إنشاءات", hours: 3 },
                    { id: "environment", name: "عمارة بيئية", hours: 2 },
                    { id: "digital", name: "رسم رقمي", hours: 2 },
                    { id: "building", name: "مواد وتقنيات البناء", hours: 3 }
                ]
            },
            electrical: {
                1: [
                    { id: "circuits1", name: "دوائر كهربائية 1", hours: 4 },
                    { id: "electronics1", name: "إلكترونيات 1", hours: 3 },
                    { id: "math1e", name: "رياضيات 1", hours: 3 },
                    { id: "programminge", name: "برمجة", hours: 3 },
                    { id: "physics1e", name: "فيزياء 1", hours: 4 }
                ],
                2: [
                    { id: "circuits2", name: "دوائر كهربائية 2", hours: 4 },
                    { id: "electronics2", name: "إلكترونيات 2", hours: 3 },
                    { id: "fields", name: "مجالات كهرومغناطيسية", hours: 3 },
                    { id: "digital", name: "منطق رقمي", hours: 3 },
                    { id: "measurements", name: "قياسات", hours: 2 }
                ]
            }
        };

        // عناصر DOM
        const departmentSelect = document.getElementById('department');
        const levelSelect = document.getElementById('level');
        const availableCourses = document.getElementById('availableCourses');
        const coursesList = document.getElementById('coursesList');
        const addSelectedBtn = document.getElementById('addSelectedCourses');
        const coursesContainer = document.getElementById('coursesContainer');
        const noCoursesMessage = document.getElementById('noCoursesMessage');
        const addCourseBtn = document.getElementById('addCourseBtn');
        const calculateBtn = document.querySelector('.calculate-btn');
        const selectedCoursesTitle = document.getElementById('selectedCoursesTitle');
        const gpaForm = document.getElementById('gpaForm');
        const resultDiv = document.getElementById('result');
        const gpaValue = document.getElementById('gpaValue');

        // تفعيل اختيار المستوى عند اختيار القسم
        departmentSelect.addEventListener('change', function() {
            if (this.value) {
                levelSelect.disabled = false;
                levelSelect.value = '';
                availableCourses.style.display = 'none';
                coursesList.innerHTML = '';
                resetCalculator();
            } else {
                levelSelect.disabled = true;
                levelSelect.value = '';
                availableCourses.style.display = 'none';
                coursesList.innerHTML = '';
                resetCalculator();
            }
        });

        // عرض المواد المتاحة عند اختيار المستوى
        levelSelect.addEventListener('change', function() {
            const department = departmentSelect.value;
            const level = this.value;
            
            if (department && level) {
                displayAvailableCourses(department, level);
                resetCalculator();
            } else {
                availableCourses.style.display = 'none';
                coursesList.innerHTML = '';
                resetCalculator();
            }
        });

        // عرض المواد المتاحة
        function displayAvailableCourses(department, level) {
            const courses = coursesData[department] && coursesData[department][level];
            
            if (!courses || courses.length === 0) {
                coursesList.innerHTML = `
                    <div class="no-courses">
                        <i class="fas fa-book"></i>
                        <p>لا توجد مواد متاحة لهذا المستوى حالياً</p>
                    </div>
                `;
                availableCourses.style.display = 'block';
                return;
            }
            
            let html = '';
            
            courses.forEach(course => {
                html += `
                    <div class="course-checkbox">
                        <input type="checkbox" id="course_${course.id}" value='${JSON.stringify(course)}'>
                        <div class="course-info">
                            <h4>${course.name}</h4>
                            <p>عدد الساعات: ${course.hours}</p>
                        </div>
                    </div>
                `;
            });
            
            coursesList.innerHTML = html;
            availableCourses.style.display = 'block';
        }

        // إضافة المواد المختارة
        addSelectedBtn.addEventListener('click', function() {
            const selectedCourses = [];
            const checkboxes = coursesList.querySelectorAll('input[type="checkbox"]:checked');
            
            checkboxes.forEach(checkbox => {
                selectedCourses.push(JSON.parse(checkbox.value));
            });
            
            if (selectedCourses.length > 0) {
                displaySelectedCourses(selectedCourses);
                availableCourses.style.display = 'none';
            } else {
                alert('يرجى اختيار مادة واحدة على الأقل');
            }
        });

        // عرض المواد المختارة في الحاسبة
        function displaySelectedCourses(courses) {
            // إخفاء رسالة عدم وجود مواد
            noCoursesMessage.style.display = 'none';
            
            // مسح المحتوى السابق
            const existingCourses = coursesContainer.querySelectorAll('.course-row');
            existingCourses.forEach(course => course.remove());
            
            // إضافة المواد الجديدة
            courses.forEach(course => {
                const courseRow = document.createElement('div');
                courseRow.classList.add('course-row');
                courseRow.innerHTML = `
                    <input type="text" value="${course.name}" readonly>
                    <select class="grade" required>
                        <option value="">اختر الدرجة</option>
                        <option value="4">A (4 points)</option>
                        <option value="3.7">A- (3.7 points)</option>
                        <option value="3.3">B+ (3.3 points)</option>
                        <option value="3">B (3 points)</option>
                        <option value="2.7">B- (2.7 points)</option>
                        <option value="2.3">C+ (2.3 points)</option>
                        <option value="2">C (2 points)</option>
                        <option value="1.7">C- (1.7 points)</option>
                        <option value="1.3">D+ (1.3 points)</option>
                        <option value="1">D (1 point)</option>
                        <option value="0">F (0 points)</option>
                    </select>
                    <input type="number" class="hours" value="${course.hours}" min="1" readonly>
                    <button type="button" class="remove-course">×</button>
                `;
                coursesContainer.appendChild(courseRow);
            });
            
            // إظهار عناصر التحكم
            addCourseBtn.style.display = 'block';
            calculateBtn.style.display = 'block';
            selectedCoursesTitle.style.display = 'block';
            
            // إضافة أحداث إزالة المواد
            document.querySelectorAll('.remove-course').forEach(btn => {
                btn.addEventListener('click', function() {
                    const courseRow = this.closest('.course-row');
                    courseRow.remove();
                    
                    // إذا لم يعد هناك مواد، إظهار الرسالة
                    if (coursesContainer.querySelectorAll('.course-row').length === 0) {
                        noCoursesMessage.style.display = 'block';
                        addCourseBtn.style.display = 'none';
                        calculateBtn.style.display = 'none';
                        selectedCoursesTitle.style.display = 'none';
                        resultDiv.style.display = 'none';
                    }
                });
            });
        }

        // إعادة تعيين الحاسبة
        function resetCalculator() {
            const courseRows = coursesContainer.querySelectorAll('.course-row');
            courseRows.forEach(row => row.remove());
            noCoursesMessage.style.display = 'block';
            addCourseBtn.style.display = 'none';
            calculateBtn.style.display = 'none';
            selectedCoursesTitle.style.display = 'none';
            resultDiv.style.display = 'none';
        }

        // إضافة مادة يدوياً (زر إضافة مادة أخرى)
        addCourseBtn.addEventListener('click', function() {
            const courseRow = document.createElement('div');
            courseRow.classList.add('course-row');
            courseRow.innerHTML = `
                <input type="text" placeholder="اسم المادة" required>
                <select class="grade" required>
                    <option value="">اختر الدرجة</option>
                    <option value="4">A (4 points)</option>
                    <option value="3.7">A- (3.7 points)</option>
                    <option value="3.3">B+ (3.3 points)</option>
                    <option value="3">B (3 points)</option>
                    <option value="2.7">B- (2.7 points)</option>
                    <option value="2.3">C+ (2.3 points)</option>
                    <option value="2">C (2 points)</option>
                    <option value="1.7">C- (1.7 points)</option>
                    <option value="1.3">D+ (1.3 points)</option>
                    <option value="1">D (1 point)</option>
                    <option value="0">F (0 points)</option>
                </select>
                <input type="number" class="hours" placeholder="عدد الساعات" min="1" required>
                <button type="button" class="remove-course">×</button>
            `;
            coursesContainer.appendChild(courseRow);
            
            // إخفاء رسالة عدم وجود مواد إذا كانت ظاهرة
            noCoursesMessage.style.display = 'none';
            
            // إضافة حدث إزالة للمادة الجديدة
            courseRow.querySelector('.remove-course').addEventListener('click', function() {
                courseRow.remove();
                
                // إذا لم يعد هناك مواد، إظهار الرسالة
                if (coursesContainer.querySelectorAll('.course-row').length === 0) {
                    noCoursesMessage.style.display = 'block';
                }
            });
        });

        // حساب المعدل
        gpaForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            let totalPoints = 0;
            let totalHours = 0;
            let isValid = true;
            
            document.querySelectorAll('.course-row').forEach(row => {
                const gradeSelect = row.querySelector('.grade');
                const hoursInput = row.querySelector('.hours');
                
                const grade = parseFloat(gradeSelect.value);
                const hours = parseFloat(hoursInput.value);
                
                if (isNaN(grade) || isNaN(hours)) {
                    isValid = false;
                    // إضافة نمط للخانة غير المكتملة
                    if (isNaN(grade)) {
                        gradeSelect.style.borderColor = 'red';
                    }
                    if (isNaN(hours)) {
                        hoursInput.style.borderColor = 'red';
                    }
                    return;
                }
                
                // إعادة تعيين نمط الخانة إذا كانت صحيحة
                gradeSelect.style.borderColor = '';
                hoursInput.style.borderColor = '';
                
                totalPoints += grade * hours;
                totalHours += hours;
            });
            
            if (!isValid || totalHours === 0) {
                alert('يرجى التأكد من إدخال جميع البيانات بشكل صحيح');
                return;
            }
            
            const gpa = totalPoints / totalHours;
            gpaValue.textContent = gpa.toFixed(2);
            resultDiv.style.display = 'block';
            
            // التمرير إلى نتيجة الحساب
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        });
    </script>

    <script src="script.js"></script>
</body>
</html>